<!-- Hereda la estructura base -->
{% extends 'tienda/base.html' %}
{% block content %}
<h2 class="text-2xl font-bold mb-4">Registrar Venta</h2>

<!-- Formulario para registrar una venta -->
<form method="post" class="space-y-4">
    {% csrf_token %}

    <!-- Datos del cliente -->
    <div>
        <label class="block">RUT Cliente:</label>
        <input type="text" name="rut" class="border border-gray-300 p-2 w-full" required>
    </div>

    <div>
        <input type="checkbox" name="habitual" id="habitual" class="mr-2">
        <label for="habitual">Cliente Habitual</label>
    </div>

    <!-- Campos adicionales para cliente habitual (nombre y correo) -->
    <div id="datos_cliente" style="display: none;">
        <label class="block">Nombre:</label>
        <input type="text" name="nombre" class="border border-gray-300 p-2 w-full">

        <label class="block mt-2">Correo:</label>
        <input type="email" name="correo" class="border border-gray-300 p-2 w-full">
    </div>

    <!-- Selección del producto a vender -->
    <div>
        <label class="block">Producto:</label>
        <select name="codigo" class="border border-gray-300 p-2 w-full" required>
            {% for prod in productos %}
                <option value="{{ prod.codigo }}">{{ prod.nombre }} ({{ prod.codigo }}) - ${{ prod.precio }} — Stock: {{ prod.cantidad }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- Cantidad de productos a vender -->
    <div>
        <label class="block">Cantidad:</label>
        <input type="number" name="cantidad" min="1" value="1" class="border border-gray-300 p-2 w-full" required>
    </div>

    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded">Registrar venta</button>
</form>

<!-- Enlace para volver a la lista de productos -->
<a href="{% url 'lista_productos' %}" class="text-blue-500 mt-4 inline-block">⬅ Volver a productos</a>

<!-- Script para mostrar/ocultar datos adicionales del cliente habitual -->
<script>
    document.getElementById('habitual').addEventListener('change', function () {
        document.getElementById('datos_cliente').style.display = this.checked ? 'block' : 'none';
    });
</script>
{% endblock %}